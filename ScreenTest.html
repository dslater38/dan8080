<html>
	<head>
		<!-- <script type="text/javascript" src="screen.test.js"></script> -->
		<script type="text/javascript" src="webgl-utils.js"></script>
		<script type="text/javascript" src="screen3d.js"></script>
		</script>
		<script type="text/javascript">
			var canvas;
			var scn;
			var cpu = {
				ram : null
			}
			
			function setPixel(i,j)
			{
				// if(i>=0 && i<224 && j>=0 && j<256)
				{
					var bitNum = (i+j*256);
					var byteNum = (bitNum>>3);
					var bit = (bitNum % 8);
					scn.vmem[byteNum] |= (1<<bit);
				}
			}
			
			function init() {
				canvas = document.getElementById("SCREEN");
				// var ctx = canvas.getContext("2d");
				var buffer = new ArrayBuffer(65536);
				cpu.ram = new DataView(buffer, 0, 65536);
				
				scn = new video.Screen(cpu, canvas,  canvas.width, canvas.height, false, 0);
				//scn.setBackground( "black");
				//scn.setForeground( "white");
				scn.clear();
				
				// scn.vmem[7164] = 255
				// scn.vmem[7167] = 128;
				
				/*
				scn.vmem[0] = 255;	// r
				scn.vmem[1] = 0;	// g
				scn.vmem[2] = 0;	// b
				scn.vmem[3] = 255;	// a
				scn.vmem[4] = 0;	// r
				scn.vmem[5] = 255;	// g
				scn.vmem[6] = 0;	// b
				scn.vmem[7] = 255;	// a
				
				scn.vmem[8] = 0;	// r
				scn.vmem[9] = 255;	// g
				scn.vmem[10] = 255;	// b
				scn.vmem[11] = 64;	// a
				*/
				
				setPixel(0,0);
				setPixel(1,0);
				setPixel(1,1);
				setPixel(0,1);
				setPixel(255,223);
				
//				for( var i=0; i<224; i++ ) {
//					setPixel(0,i);
//					setPixel(255,i);
//				}
//				for( j=0; j<255; ++j ) {
//					setPixel(j,0);
//					setPixel(j,222);
//				}
//				for( var i=0; i<223; ++i ) {
//					for( var j=0; j<i; ++j ) {
//						setPixel(i, j);
//					}
//				}
				
				/*
				for( var i=0; i<256; ++i ) {
					setPixel(i, 0);
					setPixel(i,223);
				}
				for( var j=0; j<224; ++j ) {
					setPixel(0,j);
					setPixel(255,j);
				}
				
				for( var i=0; i<224; ++i ) {
					setPixel(i,i);
				} */
				/*
				setPixel(11,1);
				setPixel(12,1);
				setPixel(13,1);
				setPixel(14,1);
//				scn.vmem[(100<<5) + 15] = 255;
//				scn.vmem[11] = 255;
				setPixel(220,220);
				setPixel(220,221);
				setPixel(220,222);
				setPixel(220,223);
				setPixel(255,223);
				setPixel(0,0);
				setPixel(1,1);
				setPixel(1,2);
				setPixel(1,3);
				setPixel(1,4);
				setPixel(1,5);
				setPixel(254,223);
				setPixel(222,220);
				setPixel(222,221);
				setPixel(222,222);
				setPixel(222,223);				
///				for( var i=0; i<128; ++i )
//					for( var j=0; j<224; ++j)
//					{
//						
//						setPixel(2*i,j);
//					}
*/
//				for( var i=0; i<224; ++i )
//					scn.vmem[i] = 255;				
				scn.draw();
				return true;
			}
			
		</script>
	</head>
	<body>
		<input type="button" value="OK" onclick="init();" />
		<canvas id="SCREEN" width="224" height="256" style="width:224px;height:256px;border-style:none;border-color:gray"/><br/>
		
	</body>
	//<script type="text/javascript">
	//var x = init();
	//</script>
</html>